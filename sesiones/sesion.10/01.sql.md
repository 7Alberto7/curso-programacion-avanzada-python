## 🧭 Sesión 10 · Punto 1 — Acceso SQL con SQLite / MySQL

### 🎯 Objetivos específicos

* Conectar Python con bases de datos **relacionales** (SQLite, MySQL).
* Ejecutar operaciones CRUD (Create, Read, Update, Delete).
* Usar tanto el módulo estándar `sqlite3` como un ORM como **SQLAlchemy**.

---

## 📚 Resumen teórico-práctico

### 🔹 Conexión con SQLite (`sqlite3`)

```python
import sqlite3

# Conexión a un archivo local (se crea si no existe)
conn = sqlite3.connect("ejemplo.db")
cur = conn.cursor()

# Crear tabla
cur.execute("""
CREATE TABLE IF NOT EXISTS usuarios (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    nombre TEXT NOT NULL,
    email TEXT UNIQUE NOT NULL
)
""")
conn.commit()

# Insertar un registro
cur.execute("INSERT INTO usuarios (nombre, email) VALUES (?, ?)", ("Ana", "ana@test.com"))
conn.commit()

# Consultar registros
cur.execute("SELECT * FROM usuarios")
print(cur.fetchall())

# Cerrar conexión
conn.close()
```

---

### 🔹 Operaciones CRUD en SQL

```python
# CREATE
cur.execute("INSERT INTO usuarios (nombre, email) VALUES (?, ?)", ("Luis", "luis@test.com"))

# READ
cur.execute("SELECT id, nombre FROM usuarios")
for row in cur.fetchall():
    print(row)

# UPDATE
cur.execute("UPDATE usuarios SET email=? WHERE nombre=?", ("nuevo@test.com", "Luis"))

# DELETE
cur.execute("DELETE FROM usuarios WHERE nombre=?", ("Luis",))
```

---

### 🔹 ORM con SQLAlchemy (ejemplo mínimo)

```python
from sqlalchemy import create_engine, Column, Integer, String
from sqlalchemy.orm import declarative_base, sessionmaker

Base = declarative_base()

class Usuario(Base):
    __tablename__ = "usuarios"
    id = Column(Integer, primary_key=True)
    nombre = Column(String, nullable=False)
    email = Column(String, unique=True, nullable=False)

# Motor SQLite (MySQL sería "mysql+pymysql://user:pass@host/db")
engine = create_engine("sqlite:///ejemplo.db")
Base.metadata.create_all(engine)

Session = sessionmaker(bind=engine)
session = Session()

# Insertar
u = Usuario(nombre="Carlos", email="carlos@test.com")
session.add(u)
session.commit()

# Consultar
for u in session.query(Usuario).all():
    print(u.id, u.nombre, u.email)
```

---

### 🔹 SQLite vs MySQL

* **SQLite**: embebido, ligero, portable → ideal para prototipos, apps locales.
* **MySQL**: servidor multiusuario, escalable → ideal para entornos productivos.

---

## 🧩 Mini-ejercicios rápidos

1. Crea una tabla `productos(id, nombre, precio)` en SQLite y añade 3 registros.
2. Recupera solo los productos con `precio > 100`.
3. Con SQLAlchemy, define la clase `Producto` y usa `session.add_all()` para insertar varios.
4. Explica con tus palabras cuándo usarías SQLite y cuándo MySQL.

---

## ✅ Checklist de dominio

* [ ] ¿Sé crear tablas y registros en SQLite desde Python?
* [ ] ¿Sé ejecutar operaciones CRUD con SQL?
* [ ] ¿Entiendo qué ventajas aporta un ORM como SQLAlchemy?
* [ ] ¿Puedo diferenciar cuándo usar SQLite vs MySQL?