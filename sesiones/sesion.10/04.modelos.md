# 🧭 Sesión 10 · Punto 4 — Scikit-learn: preprocesado y modelos simples

## 🎯 Objetivos específicos

* Conocer el flujo de trabajo básico en **machine learning** con Scikit-learn.
* Aprender a **preprocesar** datos (normalización, codificación).
* Entrenar modelos **supervisados** (clasificación, regresión).
* Probar un modelo **no supervisado** (clustering).

---

## 📚 Resumen teórico-práctico

### 🔹 Flujo de trabajo en Scikit-learn

1. Preparar datos (features `X`, etiquetas `y`).
2. Dividir en **train/test**.
3. Preprocesar (`StandardScaler`, codificación).
4. Elegir modelo → entrenar (`fit`).
5. Evaluar (`score`, métricas).

---

### 🔹 Preprocesado con `StandardScaler`

```python
import pandas as pd
from sklearn.preprocessing import StandardScaler

# Dataset de ejemplo
df = pd.DataFrame({
    "precio": [50, 100, 200],
    "cantidad": [5, 2, 8]
})

X = df[["precio", "cantidad"]]

scaler = StandardScaler()
X_norm = scaler.fit_transform(X)

print(X_norm)
```

👉 Escalado: media = 0, desviación estándar = 1.

---

### 🔹 Clasificación supervisada (Regresión logística)

```python
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression

# Etiqueta: producto caro si precio > 100
y = (df["precio"] > 100).astype(int)

X_train, X_test, y_train, y_test = train_test_split(X_norm, y, test_size=0.3, random_state=42)

modelo = LogisticRegression()
modelo.fit(X_train, y_train)

print("Accuracy:", modelo.score(X_test, y_test))
```

---

### 🔹 Regresión supervisada (LinearRegression)

```python
from sklearn.linear_model import LinearRegression

# Relación precio ~ cantidad
X = df[["cantidad"]].values
y = df["precio"].values

modelo = LinearRegression()
modelo.fit(X, y)

print("Coeficiente:", modelo.coef_, "Intercepto:", modelo.intercept_)
print("Predicción cantidad=10 →", modelo.predict([[10]]))
```

---

### 🔹 Clustering no supervisado (KMeans)

```python
from sklearn.cluster import KMeans

X = df[["precio", "cantidad"]]

kmeans = KMeans(n_clusters=2, random_state=42)
df["cluster"] = kmeans.fit_predict(X)

print(df)
```

👉 Útil para **segmentación** sin etiquetas previas.

---

## 🧩 Mini-ejercicios rápidos

1. Normaliza un dataset de ventas (`precio`, `cantidad`, `importe_total`).
2. Entrena una **regresión logística** que clasifique productos caros/baratos.
3. Usa **regresión lineal** para predecir el precio a partir de la cantidad.
4. Aplica **KMeans** con 3 clusters y analiza qué grupos aparecen.

---

## ✅ Checklist de dominio

* [ ] ¿Sé dividir mis datos en features (`X`) y etiquetas (`y`)?
* [ ] ¿Sé aplicar preprocesado con `StandardScaler`?
* [ ] ¿Sé entrenar un modelo de clasificación supervisada y evaluar su accuracy?
* [ ] ¿Puedo entrenar un modelo de regresión lineal?
* [ ] ¿Sé aplicar clustering con KMeans y añadir la etiqueta al DataFrame?